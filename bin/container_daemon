#!/bin/sh
set -e
user=filecoin
repo="$FILECOIN_PATH"

if [ `id -u` -eq 0 ]; then
  echo "Changing user to $user"
  # ensure folder is writable
  su-exec "$user" test -w "$repo" || chown -R -- "$user" "$repo"
  # restart script with new privileges
  exec su-exec "$user" "$0" "$@"
fi

# if the first argument is daemon
if [ "$1" = "daemon"] || ["$1" = "init"] ; then
  exec go-filecoin "$1" "$@"
else
  echo "ERROR: arguments have been set but the first argument isn't 'init' or 'daemon'" >&2
fi

